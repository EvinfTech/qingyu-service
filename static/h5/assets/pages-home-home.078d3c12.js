import{p as e,G as t,H as a,s as l,J as s,D as i,B as n,K as o,L as r,o as u,c,w as f,i as d,b as m,e as p,x as g,F as h,g as _,t as y,l as v,n as I,z as w,M as x,r as b,h as k,S as D,j as C,N as F}from"./index-0cdf8aad.js";import{r as H,_ as j}from"./uni-app.es.b79b333a.js";import{r as R}from"./request.4f472fa9.js";import{g as L,f as P}from"./util.4f6eae7a.js";import{_ as T}from"./_plugin-vue_export-helper.1b428a4d.js";const V=T({data:()=>({app:e(),indicatorDots:!0,vertical:!1,autoplay:!0,interval:2e3,duration:500,swiperList:[],viewHeight:0,storeInfo:{},venueReservationList:[],currentImgIndex:-1}),options:{addGlobalClass:!0},props:{scrollViewHeight:{type:Number,default:0}},mounted(){this.$nextTick((()=>this.ready()))},watch:{scrollViewHeight:function(e){e&&e>0&&this.calculatePageHeight()}},methods:{toCall(){t({phoneNumber:this.storeInfo.phone})},toMap(){a({latitude:this.storeInfo.latitude,longitude:this.storeInfo.longitude,scale:18,name:this.storeInfo.location})},ready(){this.calculatePageHeight()},calculatePageHeight(){var e=this;l(),s().in(e).select(".banner").boundingClientRect((t=>{s().in(e).select(".navBox").boundingClientRect((a=>{e.viewHeight=e.scrollViewHeight-t.height})).exec()})).exec()},appointmentVenue(){i({url:"/pages/gymnasiumInfo/gymnasiumInfo"})},toMine(){this.$emit("navigate",{detail:1})},getReservationInfo(){R({url:"wx/get/shop/surplus/count",method:"POST",data:{date:L("-")}}).then((e=>{let t=this.et7Days(),a=e.data;t.forEach((e=>{e.residue=a[`${e.date}`].count,e.basicPrice=a[`${e.date}`].money/100})),this.venueReservationList=t}))},et7Days(){let e=[];for(var t=(new Date).getTime(),a=0;a<7;a++){var l=new Date(t+864e5*a),s=l.getFullYear(),i=l.getMonth()+1,n=l.getDate();e.push({year:s,fullDate:s+"-"+P(i)+"-"+P(n),date:P(i)+"-"+P(n),day:0==a?"今日":"周"+"日一二三四五六".charAt(l.getDay()),residue:5,basicPrice:20})}return e},toDetail(e){let t=e.fullDate;if(0==e.residue)return n({icon:"none",title:"暂无场地"}),!1;i({url:"/pages/reservationDetail/reservationDetail?date="+t})},previewImg(e){this.currentImgIndex=e,o({urls:this.swiperList,current:e})}},created:async function(){let e=await this.app.getStoreInfo("reGet");r({title:e.gymnasiumName}),e.facility.includes("设施:")&&(e.facility=e.facility.split("设施:")[1]),e.serve.includes("服务:")&&(e.serve=e.serve.split("服务:")[1]),this.storeInfo=e,this.swiperList=this.storeInfo.gymnasiumImgList,this.getReservationInfo()}},[["render",function(e,t,a,l,s,i){const n=w,o=d,r=F,R=x,L=H(b("u-icon"),j),P=k,T=D;return u(),c(o,{class:"page"},{default:f((()=>[m(o,{class:"banner"},{default:f((()=>[m(R,{"indicator-dots":s.indicatorDots,class:"h-full",autoplay:s.autoplay,interval:s.interval,duration:s.duration},{default:f((()=>[(u(!0),p(h,null,g(s.swiperList,((e,t)=>(u(),c(r,{key:t},{default:f((()=>[m(o,{class:"swiper-item h-full"},{default:f((()=>[m(n,{src:e,class:"w-full h-full",mode:"",onClick:t=>i.previewImg(e)},null,8,["src","onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["indicator-dots","autoplay","interval","duration"])])),_:1}),m(o,{class:"indexInfo",style:I({height:s.viewHeight+"px"})},{default:f((()=>[m(o,{class:"commonInfo"},{default:f((()=>[m(o,{class:"flex align-center"},{default:f((()=>[m(n,{src:s.storeInfo.shop_avatar,class:"storeHeadPhoto"},null,8,["src"]),m(o,null,{default:f((()=>[m(o,{class:"gymnasiumName"},{default:f((()=>[_(y(s.storeInfo.gymnasiumName),1)])),_:1}),m(o,{class:"location"},{default:f((()=>[_(" 营业时间： "+y(s.storeInfo.businessHours),1)])),_:1})])),_:1})])),_:1}),m(o,{class:"flex align-start",onClick:i.toCall,style:{margin:"10px 0 8px 0"}},{default:f((()=>[m(o,{class:"flex align-center justify-between flex-shirnk"},{default:f((()=>[m(o,{class:"flex align-center operateItem1"},{default:f((()=>[m(L,{name:"phone-fill"}),m(o,{class:"operateItem"},{default:f((()=>[_(" 电话 ")])),_:1})])),_:1})])),_:1}),m(o,{class:"location",style:{color:"#409EFF"}},{default:f((()=>[_(y(s.storeInfo.phone),1)])),_:1})])),_:1},8,["onClick"]),m(o,{class:"flex align-start",onClick:i.toMap},{default:f((()=>[m(o,{class:"flex operateItem1 align-center flex-shirnk"},{default:f((()=>[m(L,{name:"map-fill"}),m(o,{class:"operateItem"},{default:f((()=>[_(" 地址 ")])),_:1})])),_:1}),m(o,{class:"location",style:{color:"#409EFF"}},{default:f((()=>[_(y(s.storeInfo.location),1)])),_:1})])),_:1},8,["onClick"])])),_:1}),s.storeInfo.desc?(u(),c(o,{key:0},{default:f((()=>[m(o,{class:"commonTitle"},{default:f((()=>[_(" 场馆简介 ")])),_:1}),m(o,{class:"commonValue"},{default:f((()=>[m(P,null,{default:f((()=>[_(y(s.storeInfo.desc),1)])),_:1})])),_:1})])),_:1})):v("",!0),s.storeInfo.facility?(u(),c(o,{key:1},{default:f((()=>[m(o,{class:"commonTitle"},{default:f((()=>[_(" 场馆设施 ")])),_:1}),m(o,{class:"commonValue"},{default:f((()=>[m(P,null,{default:f((()=>[_(y(s.storeInfo.facility?s.storeInfo.facility.replace(/\\n/,"\n"):""),1)])),_:1})])),_:1})])),_:1})):v("",!0),s.storeInfo.serve?(u(),c(o,{key:2},{default:f((()=>[m(o,{class:"commonTitle"},{default:f((()=>[_(" 场馆服务 ")])),_:1}),m(o,{class:"commonValue"},{default:f((()=>[m(P,null,{default:f((()=>[_(y(s.storeInfo.serve?s.storeInfo.serve.replace(/\\n/,"\n"):""),1)])),_:1})])),_:1})])),_:1})):v("",!0),m(o,{class:"venueReservationList w-full"},{default:f((()=>[m(T,{"scroll-x":!0,class:"h-full w-full"},{default:f((()=>[m(o,{class:"w-full",style:{"white-space":"nowrap"}},{default:f((()=>[(u(!0),p(h,null,g(s.venueReservationList,((e,t)=>(u(),c(o,{class:C("venueReservationItem "+(0==e.residue?"isFullBorder":"")),onClick:t=>i.toDetail(e),key:t},{default:f((()=>[m(o,{class:C("venueReservationItemTop flex flex-direction align-center justify-center "+(0==e.residue?"isFullBg":""))},{default:f((()=>[m(o,null,{default:f((()=>[_(y(e.day),1)])),_:2},1024),m(o,null,{default:f((()=>[_("("+y(e.date)+")",1)])),_:2},1024)])),_:2},1032,["class"]),m(o,{class:"venueReservationItemBottom"},{default:f((()=>[m(o,{class:"w-full flex align-center justify-between",style:I("margin-bottom: 12rpx;color: "+(0==e.residue?"#5F5F5F":"#0077FF"))},{default:f((()=>[m(P,null,{default:f((()=>[_("剩余")])),_:1}),m(P,null,{default:f((()=>[_(y(e.residue),1)])),_:2},1024)])),_:2},1032,["style"]),m(o,{class:"w-full flex align-center justify-between"},{default:f((()=>[m(P,null,{default:f((()=>[_("起订")])),_:1}),m(P,null,{default:f((()=>[_("￥"+y(e.basicPrice),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1})])),_:1},8,["style"])])),_:1})}],["__scopeId","data-v-ddfbd4e3"]]);export{V as default};
