import{d as e,m as t,a as o,r as n,o as a,c as s,w as i,e as l,F as r,b as d,n as p,g as u,t as h,l as c,f as m,j as g,h as f,A as b,p as y,B as S,C as x,D as C,i as v,I as _}from"./index-0cdf8aad.js";import{_ as T}from"./u-loading-icon.a67cb4cf.js";import{r as z,_ as k}from"./uni-app.es.b79b333a.js";import{_ as P}from"./_plugin-vue_export-helper.1b428a4d.js";import{r as B}from"./request.4f472fa9.js";const I=P({name:"u-button",mixins:[t,o,{props:{hairline:{type:Boolean,default:e.button.hairline},type:{type:String,default:e.button.type},size:{type:String,default:e.button.size},shape:{type:String,default:e.button.shape},plain:{type:Boolean,default:e.button.plain},disabled:{type:Boolean,default:e.button.disabled},loading:{type:Boolean,default:e.button.loading},loadingText:{type:[String,Number],default:e.button.loadingText},loadingMode:{type:String,default:e.button.loadingMode},loadingSize:{type:[String,Number],default:e.button.loadingSize},openType:{type:String,default:e.button.openType},formType:{type:String,default:e.button.formType},appParameter:{type:String,default:e.button.appParameter},hoverStopPropagation:{type:Boolean,default:e.button.hoverStopPropagation},lang:{type:String,default:e.button.lang},sessionFrom:{type:String,default:e.button.sessionFrom},sendMessageTitle:{type:String,default:e.button.sendMessageTitle},sendMessagePath:{type:String,default:e.button.sendMessagePath},sendMessageImg:{type:String,default:e.button.sendMessageImg},showMessageCard:{type:Boolean,default:e.button.showMessageCard},dataName:{type:String,default:e.button.dataName},throttleTime:{type:[String,Number],default:e.button.throttleTime},hoverStartTime:{type:[String,Number],default:e.button.hoverStartTime},hoverStayTime:{type:[String,Number],default:e.button.hoverStayTime},text:{type:[String,Number],default:e.button.text},icon:{type:String,default:e.button.icon},iconColor:{type:String,default:e.button.icon},color:{type:String,default:e.button.color}}}],data:()=>({}),computed:{bemClass(){return this.color?this.bem("button",["shape","size"],["disabled","plain","hairline"]):this.bem("button",["type","shape","size"],["disabled","plain","hairline"])},loadingColor(){return this.plain?this.color?this.color:uni.$u.config.color[`u-${this.type}`]:"info"===this.type?"#c9c9c9":"rgb(200, 200, 200)"},iconColorCom(){return this.iconColor?this.iconColor:this.plain?this.color?this.color:this.type:"info"===this.type?"#000000":"#ffffff"},baseColor(){let e={};return this.color&&(e.color=this.plain?this.color:"white",this.plain||(e["background-color"]=this.color),-1!==this.color.indexOf("gradient")?(e.borderTopWidth=0,e.borderRightWidth=0,e.borderBottomWidth=0,e.borderLeftWidth=0,this.plain||(e.backgroundImage=this.color)):(e.borderColor=this.color,e.borderWidth="1px",e.borderStyle="solid")),e},nvueTextStyle(){let e={};return"info"===this.type&&(e.color="#323233"),this.color&&(e.color=this.plain?this.color:"white"),e.fontSize=this.textSize+"px",e},textSize(){let e=14,{size:t}=this;return"large"===t&&(e=16),"normal"===t&&(e=14),"small"===t&&(e=12),"mini"===t&&(e=10),e}},emits:["click","getphonenumber","getuserinfo","error","opensetting","launchapp"],methods:{clickHandler(){this.disabled||this.loading||uni.$u.throttle((()=>{this.$emit("click")}),this.throttleTime)},getphonenumber(e){this.$emit("getphonenumber",e)},getuserinfo(e){this.$emit("getuserinfo",e)},error(e){this.$emit("error",e)},opensetting(e){this.$emit("opensetting",e)},launchapp(e){this.$emit("launchapp",e)}}},[["render",function(e,t,o,y,S,x){const C=z(n("u-loading-icon"),T),v=f,_=z(n("u-icon"),k),P=b;return a(),s(P,{"hover-start-time":Number(e.hoverStartTime),"hover-stay-time":Number(e.hoverStayTime),"form-type":e.formType,"open-type":e.openType,"app-parameter":e.appParameter,"hover-stop-propagation":e.hoverStopPropagation,"send-message-title":e.sendMessageTitle,"send-message-path":e.sendMessagePath,lang:e.lang,"data-name":e.dataName,"session-from":e.sessionFrom,"send-message-img":e.sendMessageImg,"show-message-card":e.showMessageCard,onGetphonenumber:x.getphonenumber,onGetuserinfo:x.getuserinfo,onError:x.error,onOpensetting:x.opensetting,onLaunchapp:x.launchapp,"hover-class":e.disabled||e.loading?"":"u-button--active",class:g(["u-button u-reset-button",x.bemClass]),style:p([x.baseColor,e.$u.addStyle(e.customStyle)]),onClick:x.clickHandler},{default:i((()=>[e.loading?(a(),l(r,{key:0},[d(C,{mode:e.loadingMode,size:1.15*e.loadingSize,color:x.loadingColor},null,8,["mode","size","color"]),d(v,{class:"u-button__loading-text",style:p([{fontSize:x.textSize+"px"}])},{default:i((()=>[u(h(e.loadingText||e.text),1)])),_:1},8,["style"])],64)):(a(),l(r,{key:1},[e.icon?(a(),s(_,{key:0,name:e.icon,color:x.iconColorCom,size:1.35*x.textSize,customStyle:{marginRight:"2px"}},null,8,["name","color","size"])):c("",!0),m(e.$slots,"default",{},(()=>[d(v,{class:"u-button__text",style:p([{fontSize:x.textSize+"px"}])},{default:i((()=>[u(h(e.text),1)])),_:1},8,["style"])]),!0)],64))])),_:3},8,["hover-start-time","hover-stay-time","form-type","open-type","app-parameter","hover-stop-propagation","send-message-title","send-message-path","lang","data-name","session-from","send-message-img","show-message-card","onGetphonenumber","onGetuserinfo","onError","onOpensetting","onLaunchapp","hover-class","style","onClick","class"])}],["__scopeId","data-v-6b0695bb"]]);const M=P({data:()=>({app:y(),phone:"",code:"",codeState:!1,seconds:60,timer:null}),methods:{validatePhoneNumber(e){if(!e)return"empty";return/^1[3456789]\d{9}$/.test(e)?"ok":"no"},async getCode(){if(this.codeState)return!1;this.timer&&clearInterval(this.timer);let e=this.validatePhoneNumber(this.phone);if("ok"!=e)return S({icon:"none",title:"no"==e?"手机号格式错误":"请输入手机号"}),!1;let t=await this.getPhoneCode();if(S({icon:"none",title:t}),"验证码已发送"==t){this.codeState=!0;let e=setInterval((()=>{this.seconds=this.seconds-1,0==this.seconds&&(this.codeState=!1,this.seconds=60,clearInterval(this.timer))}),1e3);this.timer=e}},getPhoneCode(){return new Promise(((e,t)=>{B({url:"common/get-phone-code",method:"POST",data:{phone:this.phone}}).then((t=>{200==t.code?e("验证码已发送"):500==t.code&&"刚发的验证码，5分钟有效"==t.msg&&e("不可重复获取验证码")}))}))},toLogin(){let e=this.validatePhoneNumber(this.phone);return"ok"!=e?(S({icon:"none",title:"no"==e?"手机号格式错误":"请输入手机号"}),!1):this.code?6!=this.code.length?(S({icon:"none",title:"验证码长度为6位"}),!1):void B({url:"common/phone-code-login",method:"POST",data:{phone:this.phone,code:this.code}}).then((async e=>{200==e.code?(this.app.globalData.userInfo.ouid=e.data.ouid,await this.app.getUserInfo(),S({icon:"none",title:"登录成功",success:()=>{setTimeout((()=>{x({url:"/pages/index/index"})}),1e3)}})):500==e.code&&S({icon:"none",title:e.msg})})):(S({icon:"none",title:"验证码不能为空"}),!1)},toArrgement(){C({url:"/pages/arrgement/arrgement"})}}},[["render",function(e,t,o,l,r,c){const m=v,g=_,b=z(n("u-button"),I),y=f;return a(),s(m,{class:"page"},{default:i((()=>[d(m,{class:"topBg"}),d(m,{class:"loginBox"},{default:i((()=>[d(m,{class:"topTitle"},{default:i((()=>[u("手机号登录")])),_:1}),d(m,{class:"flex align-center phoneInput solid-bottom"},{default:i((()=>[d(m,{class:"phoneInputLeft"},{default:i((()=>[u("+86")])),_:1}),d(m,{class:"rightDivide"}),d(g,{style:{"padding-left":"26rpx"},"placeholder-style":"color:#B1B4C3;font-size:32rpx",type:"text",modelValue:r.phone,"onUpdate:modelValue":t[0]||(t[0]=e=>r.phone=e),placeholder:"请输入手机号码"},null,8,["modelValue"])])),_:1}),d(m,{class:"codeInput flex align-center solid-bottom"},{default:i((()=>[d(g,{class:"flex-1","placeholder-style":"color:#B1B4C3;font-size:32rpx",type:"text",modelValue:r.code,"onUpdate:modelValue":t[1]||(t[1]=e=>r.code=e),placeholder:"请输入验证码"},null,8,["modelValue"]),d(m,{class:"codeRight",style:p("color:"+(r.codeState?"#B1B4C3":"#0077FF")+";padding-right: "+(r.codeState?"30rpx":"")+";"),onClick:c.getCode},{default:i((()=>[u(h(r.codeState?r.seconds+" s":"获取验证码"),1)])),_:1},8,["style","onClick"])])),_:1}),d(b,{onClick:c.toLogin,type:"primary",size:"large",color:"#0077FF","custom-style":"margin-top: 134rpx;border-radius: 12rpx;"},{default:i((()=>[u("登录")])),_:1},8,["onClick"])])),_:1}),d(m,{class:"bottomTitle flex flex-direction align-center"},{default:i((()=>[d(m,null,{default:i((()=>[u("未注册手机号登录后将自动生成账号且代表您")])),_:1}),d(m,null,{default:i((()=>[d(y,null,{default:i((()=>[u("已阅读并同意")])),_:1}),d(y,{class:"agreement",onClick:c.toArrgement},{default:i((()=>[u("《用户协议》")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-68ffa544"]]);export{M as default};
